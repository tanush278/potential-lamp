<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Planner Pro - Ultra Compact</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg: #000000;
            --card: #1a1a1a;
            --card-hover: #252525;
            --border: #333333;
            --text: #ffffff;
            --gray: #cccccc;
            --accent-blue: #4A90E2;
            --accent-green: #50C878;
            --accent-gold: #FFD700;
            --accent-purple: #8A2BE2;
            --accent-gradient: linear-gradient(135deg, #4A90E2, #50C878);
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #17a2b8;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%); 
            color: var(--text); 
            font-size: 14px; 
            line-height: 1.4; 
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 0 1rem; }
        
        /* PROFESSIONAL HEADER */
        .header { 
            background: linear-gradient(135deg, var(--card) 0%, #2a2a2a 100%); 
            border-bottom: 2px solid var(--accent-blue); 
            padding: 0.75rem 0; 
            position: sticky; 
            top: 0; 
            z-index: 100; 
            box-shadow: 0 2px 10px rgba(74, 144, 226, 0.3);
        }
        .header-content { display: flex; justify-content: space-between; align-items: center; }
        .logo { 
            font-size: 1.2rem; 
            font-weight: 700; 
            display: flex; 
            align-items: center; 
            gap: 0.5rem; 
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* PROFESSIONAL NAVIGATION */
        .nav { 
            background: linear-gradient(135deg, var(--card) 0%, #2a2a2a 100%); 
            border-bottom: 1px solid var(--border); 
            padding: 0.5rem 0; 
            position: sticky; 
            top: 60px; 
            z-index: 99; 
            backdrop-filter: blur(10px);
        }
        .nav-tabs { 
            display: flex; 
            gap: 0.25rem; 
            overflow-x: auto; 
            padding: 0 0.5rem; 
            scrollbar-width: thin; 
        }
        .nav-tabs::-webkit-scrollbar { height: 4px; }
        .nav-tabs::-webkit-scrollbar-track { background: var(--border); }
        .nav-tabs::-webkit-scrollbar-thumb { background: var(--accent-blue); border-radius: 2px; }
        .nav-tab { 
            background: linear-gradient(135deg, #2a2a2a 0%, #333333 100%); 
            color: var(--text); 
            border: 1px solid var(--border); 
            padding: 0.5rem 1rem; 
            border-radius: 6px; 
            cursor: pointer; 
            font-size: 0.85rem; 
            font-weight: 500;
            white-space: nowrap; 
            flex-shrink: 0; 
            transition: all 0.3s ease; 
            position: relative;
            overflow: hidden;
        }
        .nav-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(74, 144, 226, 0.2), transparent);
            transition: left 0.5s;
        }
        .nav-tab:hover::before { left: 100%; }
        .nav-tab i { font-size: 0.75rem; margin-right: 0.3rem; }
        .nav-tab:hover { 
            border-color: var(--accent-blue); 
            transform: translateY(-2px); 
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        }
        .nav-tab.active { 
            background: var(--accent-gradient); 
            color: var(--bg); 
            border-color: var(--accent-green); 
            box-shadow: 0 4px 20px rgba(74, 144, 226, 0.4);
        }
        
        /* SECTIONS */
        .section { 
            display: none; 
            padding: 1rem 0; 
            min-height: calc(100vh - 120px); 
            animation: fadeIn 0.4s ease-out;
        }
        .section.active { display: block; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* PROFESSIONAL CARDS */
        .card { 
            background: linear-gradient(135deg, var(--card) 0%, var(--card-hover) 100%); 
            border: 1px solid var(--border); 
            border-radius: 8px; 
            padding: 1.5rem; 
            margin: 1rem 0; 
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--accent-gradient);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        .card:hover { 
            border-color: var(--accent-blue); 
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(74, 144, 226, 0.2);
        }
        .card:hover::before { transform: scaleX(1); }
        .card-title { 
            font-size: 1.1rem; 
            font-weight: 600; 
            margin-bottom: 1rem; 
            display: flex; 
            align-items: center; 
            gap: 0.5rem; 
            color: var(--accent-blue);
        }
        
        /* PROFESSIONAL FORMS */
        .form-group { margin-bottom: 1rem; }
        .form-label { 
            display: block; 
            margin-bottom: 0.5rem; 
            font-size: 0.9rem; 
            font-weight: 500; 
            color: var(--accent-blue);
        }
        .form-input, .form-select { 
            width: 100%; 
            padding: 0.75rem 1rem; 
            background: linear-gradient(135deg, #2a2a2a 0%, #333333 100%); 
            border: 2px solid var(--border); 
            border-radius: 6px; 
            color: var(--text); 
            font-size: 0.9rem; 
            transition: all 0.3s ease;
        }
        .form-input:focus, .form-select:focus { 
            outline: none; 
            border-color: var(--accent-blue); 
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
            background: #333333;
        }
        
        /* PROFESSIONAL BUTTONS */
        .btn { 
            display: inline-flex; 
            align-items: center; 
            gap: 0.5rem; 
            padding: 0.75rem 1.5rem; 
            border: none; 
            border-radius: 6px; 
            font-size: 0.9rem; 
            font-weight: 500;
            cursor: pointer; 
            transition: all 0.3s ease; 
            position: relative;
            overflow: hidden;
        }
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        .btn:hover::before { left: 100%; }
        .btn-primary { 
            background: var(--accent-gradient); 
            color: var(--bg); 
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
        }
        .btn-secondary { 
            background: linear-gradient(135deg, var(--card) 0%, var(--card-hover) 100%); 
            color: var(--text); 
            border: 2px solid var(--border); 
        }
        .btn-secondary:hover {
            border-color: var(--accent-blue);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.2);
        }
        
        /* PROFESSIONAL GRID */
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; }
        .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; }
        
        /* PROFILE MANAGEMENT */
        .profile-screen { min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 1rem; }
        .profile-content { max-width: 600px; text-align: center; }
        .profile-title { 
            font-size: 2.5rem; 
            font-weight: 700; 
            margin-bottom: 1rem; 
            background: var(--accent-gradient); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .profiles-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0.4rem; margin: 1rem 0; }
        .profile-item { background: var(--card); border: 1px solid var(--border); border-radius: 4px; padding: 0.5rem; cursor: pointer; transition: all 0.2s; }
        .profile-item:hover { transform: translateY(-2px); border-color: var(--text); }
        .profile-item h4 { font-size: 0.8rem; margin-bottom: 0.1rem; }
        .profile-item p { color: var(--gray); font-size: 0.6rem; margin-bottom: 0.05rem; }
        .profile-actions { display: flex; gap: 0.2rem; margin-top: 0.3rem; }
        
        /* UTILITIES */
        .hidden { display: none; }
        .flex { display: flex; }
        .flex-center { display: flex; align-items: center; justify-content: center; }
        .gap-1 { gap: 0.2rem; }
        .text-center { text-align: center; }
        .text-success { color: var(--accent-green); }
        .text-error { color: var(--danger); }
        .text-warning { color: var(--warning); }
        .text-info { color: var(--accent-blue); }
        .text-gray { color: var(--gray); }
        .mb-1 { margin-bottom: 0.2rem; }
        .mt-1 { margin-top: 0.2rem; }
        .mt-2 { margin-top: 0.4rem; }
        
        @media (max-width: 768px) {
            .grid-2, .grid-3 { grid-template-columns: 1fr; }
            .nav-tab { font-size: 0.5rem; padding: 0.08rem 0.2rem; }
        }
    </style>
</head>
<body>
    <!-- Profile Management -->
    <div id="profileScreen" class="profile-screen">
        <div class="profile-content">
            <h1 class="profile-title"><i class="fas fa-chart-line"></i> Financial Planner Pro</h1>
            <p class="text-gray mb-1">Ultra Compact Professional Suite</p>
            <div id="profilesList" class="profiles-grid"></div>
            <div class="flex-center gap-1 mt-2">
                <button class="btn btn-primary" onclick="createProfile()"><i class="fas fa-plus"></i> New</button>
                <button class="btn btn-secondary" onclick="importData()"><i class="fas fa-upload"></i> Import</button>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden">
        <!-- Header -->
        <header class="header">
            <div class="container">
                <div class="header-content">
                    <div class="logo"><i class="fas fa-chart-line"></i> Financial Planner Pro</div>
                    <div class="flex gap-1">
                        <span id="profileName" class="text-gray" style="font-size: 0.6rem;">No Profile</span>
                        <button class="btn btn-secondary" onclick="showProfiles()"><i class="fas fa-user"></i></button>
                        <button class="btn btn-secondary" onclick="saveData()"><i class="fas fa-save"></i></button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav">
            <div class="container">
                <div class="nav-tabs">
                    <button class="nav-tab active" onclick="showSection('personality')"><i class="fas fa-brain"></i> Personality</button>
                    <button class="nav-tab" onclick="showSection('profile')"><i class="fas fa-user"></i> Profile</button>
                    <button class="nav-tab" onclick="showSection('financial')"><i class="fas fa-money-bill"></i> Financial</button>
                    <button class="nav-tab" onclick="showSection('networth')"><i class="fas fa-chart-bar"></i> Net Worth</button>
                    <button class="nav-tab" onclick="showSection('goals')"><i class="fas fa-target"></i> Goals</button>
                    <button class="nav-tab" onclick="showSection('risk')"><i class="fas fa-shield-alt"></i> Risk</button>
                    <button class="nav-tab" onclick="showSection('investment')"><i class="fas fa-chart-line"></i> Investment</button>
                    <button class="nav-tab" onclick="showSection('analytics')"><i class="fas fa-analytics"></i> Analytics</button>
                    <button class="nav-tab" onclick="showSection('reports')"><i class="fas fa-file-alt"></i> Reports</button>
                    <button class="nav-tab" onclick="showSection('summary')"><i class="fas fa-clipboard-list"></i> Summary</button>
                    <button class="nav-tab" onclick="showSection('tools')"><i class="fas fa-tools"></i> Tools</button>
                </div>
            </div>
        </nav>

        <!-- Content -->
        <div class="container">
            <!-- Personality Section -->
            <section id="personalitySection" class="section active">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-brain"></i> Personality Assessment</h2>
                    <div id="assessmentContent">
                        <p class="mb-1">Complete this assessment to understand your financial personality.</p>
                        <div class="flex gap-1">
                            <button class="btn btn-primary" onclick="startAssessment()"><i class="fas fa-play"></i> Start</button>
                            <button class="btn btn-secondary" onclick="resetAssessment()"><i class="fas fa-redo"></i> Reset</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Profile Section -->
            <section id="profileSection" class="section">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-user"></i> Client Profile</h2>
                    <div class="grid-2">
                        <div class="form-group">
                            <label class="form-label">Full Name</label>
                            <input type="text" class="form-input" id="clientName" placeholder="Enter name">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Age</label>
                            <input type="number" class="form-input" id="clientAge" placeholder="Age">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-input" id="clientEmail" placeholder="Email">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Phone</label>
                            <input type="tel" class="form-input" id="clientPhone" placeholder="Phone">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Occupation</label>
                            <input type="text" class="form-input" id="clientOccupation" placeholder="Occupation">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Marital Status</label>
                            <select class="form-select" id="maritalStatus">
                                <option value="">Select</option>
                                <option value="single">Single</option>
                                <option value="married">Married</option>
                                <option value="divorced">Divorced</option>
                            </select>
                        </div>
                    </div>
                    <div class="flex gap-1 mt-1">
                        <button class="btn btn-primary" onclick="saveProfile()"><i class="fas fa-save"></i> Save</button>
                        <button class="btn btn-secondary" onclick="clearProfile()"><i class="fas fa-eraser"></i> Clear</button>
                    </div>
                </div>
            </section>

            <!-- Financial Section -->
            <section id="financialSection" class="section">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-money-bill"></i> Financial Status</h2>
                    <div class="grid-2">
                        <div class="form-group">
                            <label class="form-label">Monthly Income</label>
                            <input type="number" class="form-input" id="monthlyIncome" placeholder="Income">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Monthly Expenses</label>
                            <input type="number" class="form-input" id="monthlyExpenses" placeholder="Expenses">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Current Savings</label>
                            <input type="number" class="form-input" id="currentSavings" placeholder="Savings">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Outstanding Debt</label>
                            <input type="number" class="form-input" id="outstandingDebt" placeholder="Debt">
                        </div>
                    </div>
                    <div class="flex gap-1 mt-1">
                        <button class="btn btn-primary" onclick="saveFinancial()"><i class="fas fa-save"></i> Save</button>
                        <button class="btn btn-secondary" onclick="calculateNet()"><i class="fas fa-calculator"></i> Calculate</button>
                    </div>
                    <div id="netResult" class="mt-1"></div>
                </div>
            </section>

            <!-- Net Worth Section -->
            <section id="networthSection" class="section">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-chart-bar"></i> Net Worth Calculator</h2>
                    <div class="grid-2">
                        <div>
                            <h3 style="font-size: 0.7rem; margin-bottom: 0.2rem;">Assets</h3>
                            <div id="assetsList"></div>
                            <div class="flex gap-1 mt-1">
                                <input type="text" class="form-input" id="assetName" placeholder="Asset" style="flex: 1;">
                                <input type="number" class="form-input" id="assetValue" placeholder="Value" style="flex: 1;">
                                <button class="btn btn-primary" onclick="addAsset()"><i class="fas fa-plus"></i></button>
                            </div>
                        </div>
                        <div>
                            <h3 style="font-size: 0.7rem; margin-bottom: 0.2rem;">Liabilities</h3>
                            <div id="liabilitiesList"></div>
                            <div class="flex gap-1 mt-1">
                                <input type="text" class="form-input" id="liabilityName" placeholder="Liability" style="flex: 1;">
                                <input type="number" class="form-input" id="liabilityValue" placeholder="Value" style="flex: 1;">
                                <button class="btn btn-primary" onclick="addLiability()"><i class="fas fa-plus"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="flex gap-1 mt-1">
                        <button class="btn btn-primary" onclick="calculateNetWorth()"><i class="fas fa-calculator"></i> Calculate</button>
                    </div>
                    <div id="netWorthResult" class="mt-1"></div>
                </div>
            </section>

            <!-- Goals Section -->
            <section id="goalsSection" class="section">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-target"></i> Financial Goals</h2>
                    <div id="goalsList"></div>
                    <div class="grid-3 mt-1">
                        <input type="text" class="form-input" id="goalName" placeholder="Goal">
                        <input type="number" class="form-input" id="goalAmount" placeholder="Amount">
                        <input type="number" class="form-input" id="goalYears" placeholder="Years">
                    </div>
                    <div class="flex gap-1 mt-1">
                        <button class="btn btn-primary" onclick="addGoal()"><i class="fas fa-plus"></i> Add</button>
                        <button class="btn btn-secondary" onclick="calculateSIP()"><i class="fas fa-calculator"></i> SIP</button>
                    </div>
                    <div id="sipResult" class="mt-1"></div>
                </div>
            </section>

            <!-- Risk Section -->
            <section id="riskSection" class="section">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-shield-alt"></i> Risk Profile</h2>
                    <div class="form-group">
                        <label class="form-label">Risk Tolerance</label>
                        <select class="form-select" id="riskTolerance">
                            <option value="">Select</option>
                            <option value="conservative">Conservative</option>
                            <option value="moderate">Moderate</option>
                            <option value="aggressive">Aggressive</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Investment Horizon</label>
                        <select class="form-select" id="investmentHorizon">
                            <option value="">Select</option>
                            <option value="short">Short Term (1-3 years)</option>
                            <option value="medium">Medium Term (3-7 years)</option>
                            <option value="long">Long Term (7+ years)</option>
                        </select>
                    </div>
                    <div class="flex gap-1 mt-1">
                        <button class="btn btn-primary" onclick="saveRisk()"><i class="fas fa-save"></i> Save</button>
                        <button class="btn btn-secondary" onclick="generateRiskReport()"><i class="fas fa-chart-pie"></i> Report</button>
                    </div>
                    <div id="riskResult" class="mt-1"></div>
                </div>
            </section>

            <!-- Investment Section -->
            <section id="investmentSection" class="section">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-chart-line"></i> Investment Advisory</h2>
                    <p class="mb-1" style="font-size: 0.65rem;">Investment recommendations based on your profile:</p>
                    <div id="investmentRecommendations">
                        <div class="card">
                            <h4 style="font-size: 0.7rem;">Asset Allocation</h4>
                            <div id="assetAllocation" class="mt-1"></div>
                        </div>
                    </div>
                    <div class="flex gap-1 mt-1">
                        <button class="btn btn-primary" onclick="generatePlan()"><i class="fas fa-magic"></i> Generate</button>
                        <button class="btn btn-secondary" onclick="simulatePortfolio()"><i class="fas fa-chart-area"></i> Simulate</button>
                    </div>
                </div>
            </section>

            <!-- Analytics Section -->
            <section id="analyticsSection" class="section">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-analytics"></i> Analytics Dashboard</h2>
                    <div class="grid-2">
                        <div class="card">
                            <h4 style="font-size: 0.7rem;">Performance</h4>
                            <p class="text-gray" style="font-size: 0.6rem;">Chart placeholder</p>
                        </div>
                        <div class="card">
                            <h4 style="font-size: 0.7rem;">Allocation</h4>
                            <p class="text-gray" style="font-size: 0.6rem;">Chart placeholder</p>
                        </div>
                    </div>
                    <div class="flex gap-1 mt-1">
                        <button class="btn btn-primary" onclick="refreshAnalytics()"><i class="fas fa-sync"></i> Refresh</button>
                        <button class="btn btn-secondary" onclick="exportAnalytics()"><i class="fas fa-download"></i> Export</button>
                    </div>
                </div>
            </section>

            <!-- Reports Section -->
            <section id="reportsSection" class="section">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-file-alt"></i> Reports</h2>
                    <div class="grid-3">
                        <button class="btn btn-primary" onclick="generatePDF()"><i class="fas fa-file-pdf"></i> PDF</button>
                        <button class="btn btn-primary" onclick="generateExcel()"><i class="fas fa-file-excel"></i> Excel</button>
                        <button class="btn btn-primary" onclick="generatePPT()"><i class="fas fa-file-powerpoint"></i> PPT</button>
                    </div>
                </div>
            </section>

            <!-- Summary Section -->
            <section id="summarySection" class="section">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-clipboard-list"></i> Executive Summary</h2>
                    <div id="executiveSummary">
                        <p class="text-gray" style="font-size: 0.65rem;">Complete profile to see summary.</p>
                    </div>
                    <div class="flex gap-1 mt-1">
                        <button class="btn btn-primary" onclick="generateSummary()"><i class="fas fa-magic"></i> Generate</button>
                        <button class="btn btn-secondary" onclick="emailSummary()"><i class="fas fa-envelope"></i> Email</button>
                    </div>
                </div>
            </section>

            <!-- Tools Section -->
            <section id="toolsSection" class="section">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-tools"></i> Advanced Tools</h2>
                    <div class="grid-3">
                        <button class="btn btn-primary" onclick="retirementCalc()"><i class="fas fa-calculator"></i> Retirement</button>
                        <button class="btn btn-primary" onclick="taxPlanner()"><i class="fas fa-receipt"></i> Tax</button>
                        <button class="btn btn-primary" onclick="loanCalc()"><i class="fas fa-home"></i> Loan</button>
                        <button class="btn btn-primary" onclick="insuranceCalc()"><i class="fas fa-shield-alt"></i> Insurance</button>
                        <button class="btn btn-primary" onclick="sipCalc()"><i class="fas fa-chart-line"></i> SIP</button>
                        <button class="btn btn-primary" onclick="emiCalc()"><i class="fas fa-credit-card"></i> EMI</button>
                    </div>
                    <div id="toolResult" class="mt-1"></div>
                </div>
            </section>
        </div>
    </div>

    <script>
        // Global Variables
        let currentProfile = null;
        let profiles = JSON.parse(localStorage.getItem('financialProfiles') || '{}');
        let clientData = {};

        // Initialize
        document.addEventListener('DOMContentLoaded', loadProfiles);

        // Profile Management
        function loadProfiles() {
            const list = document.getElementById('profilesList');
            list.innerHTML = '';
            
            if (Object.keys(profiles).length === 0) {
                list.innerHTML = '<p class="text-gray text-center" style="font-size: 0.65rem;">No profiles found.</p>';
                return;
            }
            
            Object.entries(profiles).forEach(([id, profile]) => {
                const item = document.createElement('div');
                item.className = 'profile-item';
                item.innerHTML = `
                    <h4>${profile.name || 'Unnamed'}</h4>
                    <p>Created: ${new Date(profile.created).toLocaleDateString()}</p>
                    <div class="profile-actions">
                        <button class="btn btn-primary" onclick="loadProfile('${id}')"><i class="fas fa-folder-open"></i> Open</button>
                        <button class="btn btn-secondary" onclick="deleteProfile('${id}')"><i class="fas fa-trash"></i></button>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function createProfile() {
            const name = prompt('Profile name:');
            if (!name) return;
            
            const id = Date.now().toString();
            profiles[id] = {
                id, name, created: Date.now(), modified: Date.now(), data: {}
            };
            localStorage.setItem('financialProfiles', JSON.stringify(profiles));
            loadProfile(id);
        }

        function loadProfile(id) {
            currentProfile = profiles[id];
            if (currentProfile) {
                clientData = currentProfile.data || {};
                document.getElementById('profileName').textContent = currentProfile.name;
                showMainApp();
                populateData();
            }
        }

        function deleteProfile(id) {
            if (confirm('Delete this profile?')) {
                delete profiles[id];
                localStorage.setItem('financialProfiles', JSON.stringify(profiles));
                loadProfiles();
            }
        }

        function saveData() {
            if (!currentProfile) {
                alert('No profile selected');
                return;
            }
            currentProfile.data = clientData;
            currentProfile.modified = Date.now();
            profiles[currentProfile.id] = currentProfile;
            localStorage.setItem('financialProfiles', JSON.stringify(profiles));
            showAlert('Saved!', 'success');
        }

        // Navigation
        function showProfiles() {
            document.getElementById('profileScreen').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');
            loadProfiles();
        }

        function showMainApp() {
            document.getElementById('profileScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
        }

        function showSection(section) {
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
            document.getElementById(section + 'Section').classList.add('active');
        }

        // Assessment
        function startAssessment() {
            const questions = [
                { q: "Market volatility reaction?", options: ["Panic and sell", "Stay invested", "Buy more"], scores: [1,2,3] },
                { q: "Investment timeline?", options: ["<5 years", "5-15 years", ">15 years"], scores: [1,2,3] },
                { q: "Liquidity importance?", options: ["Very important", "Somewhat", "Not important"], scores: [1,2,3] }
            ];
            
            let html = '';
            questions.forEach((item, i) => {
                html += `<div class="card mb-1">
                    <h4 style="font-size: 0.7rem;">${item.q}</h4>
                    ${item.options.map((opt, j) => `
                        <label class="flex gap-1" style="font-size: 0.6rem; margin: 0.1rem 0;">
                            <input type="radio" name="q${i}" value="${item.scores[j]}"> ${opt}
                        </label>
                    `).join('')}
                </div>`;
            });
            
            html += '<button class="btn btn-primary mt-1" onclick="submitAssessment()"><i class="fas fa-check"></i> Submit</button>';
            document.getElementById('assessmentContent').innerHTML = html;
        }

        function submitAssessment() {
            let score = 0, count = 0;
            for (let i = 0; i < 3; i++) {
                const answer = document.querySelector(`input[name="q${i}"]:checked`);
                if (answer) { score += parseInt(answer.value); count++; }
            }
            
            if (count < 3) { alert('Answer all questions'); return; }
            
            const avg = score / count;
            const risk = avg <= 1.5 ? 'Conservative' : avg <= 2.5 ? 'Moderate' : 'Aggressive';
            
            clientData.assessmentScore = score;
            clientData.riskProfile = risk;
            
            document.getElementById('assessmentContent').innerHTML += `
                <div class="card mt-1">
                    <h4 style="font-size: 0.7rem;">Results</h4>
                    <p style="font-size: 0.6rem;"><strong>Score:</strong> ${score}</p>
                    <p style="font-size: 0.6rem;"><strong>Risk Profile:</strong> ${risk}</p>
                </div>
            `;
            showAlert('Assessment completed!', 'success');
        }

        function resetAssessment() {
            document.getElementById('assessmentContent').innerHTML = `
                <p class="mb-1" style="font-size: 0.65rem;">Complete this assessment to understand your financial personality.</p>
                <div class="flex gap-1">
                    <button class="btn btn-primary" onclick="startAssessment()"><i class="fas fa-play"></i> Start</button>
                    <button class="btn btn-secondary" onclick="resetAssessment()"><i class="fas fa-redo"></i> Reset</button>
                </div>
            `;
        }

        // Profile Functions
        function saveProfile() {
            clientData.name = document.getElementById('clientName').value;
            clientData.age = document.getElementById('clientAge').value;
            clientData.email = document.getElementById('clientEmail').value;
            clientData.phone = document.getElementById('clientPhone').value;
            clientData.occupation = document.getElementById('clientOccupation').value;
            clientData.maritalStatus = document.getElementById('maritalStatus').value;
            showAlert('Profile saved!', 'success');
        }

        function clearProfile() {
            ['clientName', 'clientAge', 'clientEmail', 'clientPhone', 'clientOccupation', 'maritalStatus'].forEach(id => {
                document.getElementById(id).value = '';
            });
        }

        // Financial Functions
        function saveFinancial() {
            clientData.monthlyIncome = parseFloat(document.getElementById('monthlyIncome').value) || 0;
            clientData.monthlyExpenses = parseFloat(document.getElementById('monthlyExpenses').value) || 0;
            clientData.currentSavings = parseFloat(document.getElementById('currentSavings').value) || 0;
            clientData.outstandingDebt = parseFloat(document.getElementById('outstandingDebt').value) || 0;
            showAlert('Financial data saved!', 'success');
        }

        function calculateNet() {
            const income = parseFloat(document.getElementById('monthlyIncome').value) || 0;
            const expenses = parseFloat(document.getElementById('monthlyExpenses').value) || 0;
            const net = income - expenses;
            
            document.getElementById('netResult').innerHTML = `
                <div class="card">
                    <h4 style="font-size: 0.7rem;">Net Monthly Income</h4>
                    <p class="text-${net >= 0 ? 'success' : 'error'}" style="font-size: 0.7rem;">₹${net.toLocaleString()}</p>
                </div>
            `;
        }

        // Net Worth Functions
        function addAsset() {
            const name = document.getElementById('assetName').value;
            const value = parseFloat(document.getElementById('assetValue').value);
            if (!name || !value) { alert('Enter asset name and value'); return; }
            
            if (!clientData.assets) clientData.assets = [];
            clientData.assets.push({ name, value });
            
            document.getElementById('assetName').value = '';
            document.getElementById('assetValue').value = '';
            displayAssets();
        }

        function addLiability() {
            const name = document.getElementById('liabilityName').value;
            const value = parseFloat(document.getElementById('liabilityValue').value);
            if (!name || !value) { alert('Enter liability name and value'); return; }
            
            if (!clientData.liabilities) clientData.liabilities = [];
            clientData.liabilities.push({ name, value });
            
            document.getElementById('liabilityName').value = '';
            document.getElementById('liabilityValue').value = '';
            displayLiabilities();
        }

        function displayAssets() {
            const list = document.getElementById('assetsList');
            if (!clientData.assets || clientData.assets.length === 0) {
                list.innerHTML = '<p class="text-gray" style="font-size: 0.6rem;">No assets</p>';
                return;
            }
            
            list.innerHTML = clientData.assets.map((asset, i) => `
                <div class="flex gap-1 mb-1" style="font-size: 0.6rem;">
                    <span style="flex: 1;">${asset.name}</span>
                    <span>₹${asset.value.toLocaleString()}</span>
                    <button class="btn btn-secondary" onclick="removeAsset(${i})"><i class="fas fa-trash"></i></button>
                </div>
            `).join('');
        }

        function displayLiabilities() {
            const list = document.getElementById('liabilitiesList');
            if (!clientData.liabilities || clientData.liabilities.length === 0) {
                list.innerHTML = '<p class="text-gray" style="font-size: 0.6rem;">No liabilities</p>';
                return;
            }
            
            list.innerHTML = clientData.liabilities.map((liability, i) => `
                <div class="flex gap-1 mb-1" style="font-size: 0.6rem;">
                    <span style="flex: 1;">${liability.name}</span>
                    <span>₹${liability.value.toLocaleString()}</span>
                    <button class="btn btn-secondary" onclick="removeLiability(${i})"><i class="fas fa-trash"></i></button>
                </div>
            `).join('');
        }

        function removeAsset(i) { clientData.assets.splice(i, 1); displayAssets(); }
        function removeLiability(i) { clientData.liabilities.splice(i, 1); displayLiabilities(); }

        function calculateNetWorth() {
            const totalAssets = (clientData.assets || []).reduce((sum, asset) => sum + asset.value, 0);
            const totalLiabilities = (clientData.liabilities || []).reduce((sum, liability) => sum + liability.value, 0);
            const netWorth = totalAssets - totalLiabilities;
            
            document.getElementById('netWorthResult').innerHTML = `
                <div class="card">
                    <h4 style="font-size: 0.7rem;">Net Worth Summary</h4>
                    <div class="grid-3" style="font-size: 0.6rem;">
                        <div><p class="text-success">Assets: ₹${totalAssets.toLocaleString()}</p></div>
                        <div><p class="text-error">Liabilities: ₹${totalLiabilities.toLocaleString()}</p></div>
                        <div><p class="text-${netWorth >= 0 ? 'success' : 'error'}">Net Worth: ₹${netWorth.toLocaleString()}</p></div>
                    </div>
                </div>
            `;
        }

        // Goals Functions
        function addGoal() {
            const name = document.getElementById('goalName').value;
            const amount = parseFloat(document.getElementById('goalAmount').value);
            const years = parseFloat(document.getElementById('goalYears').value);
            
            if (!name || !amount || !years) { alert('Enter all goal details'); return; }
            
            if (!clientData.goals) clientData.goals = [];
            clientData.goals.push({ name, amount, years });
            
            document.getElementById('goalName').value = '';
            document.getElementById('goalAmount').value = '';
            document.getElementById('goalYears').value = '';
            
            displayGoals();
        }

        function displayGoals() {
            const list = document.getElementById('goalsList');
            if (!clientData.goals || clientData.goals.length === 0) {
                list.innerHTML = '<p class="text-gray" style="font-size: 0.6rem;">No goals added</p>';
                return;
            }
            
            list.innerHTML = clientData.goals.map((goal, i) => `
                <div class="card mb-1">
                    <div class="flex gap-1">
                        <div style="flex: 1; font-size: 0.6rem;">
                            <h4 style="font-size: 0.7rem;">${goal.name}</h4>
                            <p>₹${goal.amount.toLocaleString()} in ${goal.years} years</p>
                        </div>
                        <button class="btn btn-secondary" onclick="removeGoal(${i})"><i class="fas fa-trash"></i></button>
                    </div>
                </div>
            `).join('');
        }

        function removeGoal(i) { clientData.goals.splice(i, 1); displayGoals(); }

        function calculateSIP() {
            if (!clientData.goals || clientData.goals.length === 0) { alert('Add a goal first'); return; }
            
            const goal = clientData.goals[clientData.goals.length - 1];
            const monthlyRate = 0.12 / 12;
            const months = goal.years * 12;
            const monthlySIP = goal.amount * monthlyRate / (Math.pow(1 + monthlyRate, months) - 1);
            
            document.getElementById('sipResult').innerHTML = `
                <div class="card">
                    <h4 style="font-size: 0.7rem;">SIP for ${goal.name}</h4>
                    <p style="font-size: 0.6rem;">Monthly SIP: ₹${Math.round(monthlySIP).toLocaleString()}</p>
                    <p class="text-gray" style="font-size: 0.55rem;">*Assuming 12% annual return</p>
                </div>
            `;
        }

        // Risk Functions
        function saveRisk() {
            clientData.riskTolerance = document.getElementById('riskTolerance').value;
            clientData.investmentHorizon = document.getElementById('investmentHorizon').value;
            showAlert('Risk profile saved!', 'success');
        }

        function generateRiskReport() {
            const risk = document.getElementById('riskTolerance').value;
            const horizon = document.getElementById('investmentHorizon').value;
            
            if (!risk || !horizon) { alert('Select risk tolerance and horizon'); return; }
            
            const allocations = {
                conservative: { equity: 30, debt: 60, gold: 10 },
                moderate: { equity: 60, debt: 30, gold: 10 },
                aggressive: { equity: 80, debt: 15, gold: 5 }
            };
            
            const allocation = allocations[risk] || allocations.moderate;
            
            document.getElementById('riskResult').innerHTML = `
                <div class="card">
                    <h4 style="font-size: 0.7rem;">Recommended Allocation</h4>
                    <div class="grid-3" style="font-size: 0.6rem;">
                        <div><p class="text-success">Equity: ${allocation.equity}%</p></div>
                        <div><p class="text-gray">Debt: ${allocation.debt}%</p></div>
                        <div><p class="text-error">Gold: ${allocation.gold}%</p></div>
                    </div>
                </div>
            `;
        }

        // Tool Functions
        function retirementCalc() {
            document.getElementById('toolResult').innerHTML = `
                <div class="card">
                    <h4 style="font-size: 0.7rem;">Retirement Calculator</h4>
                    <div class="grid-2">
                        <input type="number" class="form-input" id="currentAge" placeholder="Current age">
                        <input type="number" class="form-input" id="retirementAge" placeholder="Retirement age">
                        <input type="number" class="form-input" id="monthlyExp" placeholder="Monthly expenses">
                        <input type="number" class="form-input" id="expectedReturn" placeholder="Expected return %" value="12">
                    </div>
                    <button class="btn btn-primary mt-1" onclick="calcRetirement()"><i class="fas fa-calculator"></i> Calculate</button>
                    <div id="retirementResult" class="mt-1"></div>
                </div>
            `;
        }

        function calcRetirement() {
            const currentAge = parseInt(document.getElementById('currentAge').value);
            const retirementAge = parseInt(document.getElementById('retirementAge').value);
            const monthlyExp = parseFloat(document.getElementById('monthlyExp').value);
            const expectedReturn = parseFloat(document.getElementById('expectedReturn').value) / 100;
            
            if (!currentAge || !retirementAge || !monthlyExp) { alert('Fill all fields'); return; }
            
            const years = retirementAge - currentAge;
            const inflationRate = 0.06;
            const futureExp = monthlyExp * Math.pow(1 + inflationRate, years);
            const corpus = futureExp * 12 * 25;
            const monthlyRate = expectedReturn / 12;
            const months = years * 12;
            const sip = corpus * monthlyRate / (Math.pow(1 + monthlyRate, months) - 1);
            
            document.getElementById('retirementResult').innerHTML = `
                <div class="card">
                    <h5 style="font-size: 0.65rem;">Retirement Planning</h5>
                    <p style="font-size: 0.6rem;">Corpus needed: ₹${Math.round(corpus).toLocaleString()}</p>
                    <p style="font-size: 0.6rem;">Monthly SIP: ₹${Math.round(sip).toLocaleString()}</p>
                </div>
            `;
        }

        // Placeholder Functions
        function importData() { showAlert('Import feature coming soon!', 'info'); }
        function generatePlan() { showAlert('Investment plan generation coming soon!', 'info'); }
        function simulatePortfolio() { showAlert('Portfolio simulation coming soon!', 'info'); }
        function refreshAnalytics() { showAlert('Analytics refreshed!', 'success'); }
        function exportAnalytics() { showAlert('Export feature coming soon!', 'info'); }
        function generatePDF() { showAlert('PDF generation coming soon!', 'info'); }
        function generateExcel() { showAlert('Excel generation coming soon!', 'info'); }
        function generatePPT() { showAlert('PPT generation coming soon!', 'info'); }
        function generateSummary() { showAlert('Summary generation coming soon!', 'info'); }
        function emailSummary() { showAlert('Email feature coming soon!', 'info'); }
        function taxPlanner() { showAlert('Tax planner coming soon!', 'info'); }
        function loanCalc() { showAlert('Loan calculator coming soon!', 'info'); }
        function insuranceCalc() { showAlert('Insurance calculator coming soon!', 'info'); }
        function sipCalc() { showAlert('SIP calculator coming soon!', 'info'); }
        function emiCalc() { showAlert('EMI calculator coming soon!', 'info'); }

        // Utility Functions
        function populateData() {
            if (clientData.name) document.getElementById('clientName').value = clientData.name;
            if (clientData.age) document.getElementById('clientAge').value = clientData.age;
            if (clientData.email) document.getElementById('clientEmail').value = clientData.email;
            if (clientData.phone) document.getElementById('clientPhone').value = clientData.phone;
            if (clientData.occupation) document.getElementById('clientOccupation').value = clientData.occupation;
            if (clientData.maritalStatus) document.getElementById('maritalStatus').value = clientData.maritalStatus;
            
            if (clientData.monthlyIncome) document.getElementById('monthlyIncome').value = clientData.monthlyIncome;
            if (clientData.monthlyExpenses) document.getElementById('monthlyExpenses').value = clientData.monthlyExpenses;
            if (clientData.currentSavings) document.getElementById('currentSavings').value = clientData.currentSavings;
            if (clientData.outstandingDebt) document.getElementById('outstandingDebt').value = clientData.outstandingDebt;
            
            if (clientData.riskTolerance) document.getElementById('riskTolerance').value = clientData.riskTolerance;
            if (clientData.investmentHorizon) document.getElementById('investmentHorizon').value = clientData.investmentHorizon;
            
            displayAssets();
            displayLiabilities();
            displayGoals();
        }

        function showAlert(message, type = 'info') {
            const colors = { success: '#4CAF50', error: '#f44336', info: '#2196F3' };
            const alert = document.createElement('div');
            alert.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 1000;
                background: ${colors[type] || colors.info}; color: white;
                padding: 0.5rem 1rem; border-radius: 4px; font-size: 0.7rem;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            `;
            alert.textContent = message;
            document.body.appendChild(alert);
            setTimeout(() => alert.remove(), 3000);
        }

        // Auto-save every 30 seconds
        setInterval(() => {
            if (currentProfile && Object.keys(clientData).length > 0) {
                saveData();
            }
        }, 30000);
    </script>
</body>
</html>
